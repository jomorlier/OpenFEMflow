clear all
close all
clc

%%

syms x y R S
syms x1 x2 x3 x4 y1 y2 y3 y4


%% 

% [R, S] = solve([1/4*(1-R)*(1-S)*x1+1/4*(1+R)*(1-S)*x2+1/4*(1+R)*(1+S)*x3+1/4*(1-R)*(1+S)*x4-x ==0, 1/4*(1-R)*(1-S)*y1+1/4*(1+R)*(1-S)*y2+1/4*(1+R)*(1+S)*y3+1/4*(1-R)*(1+S)*y4-y==0],[R,S])

R =  (x*y1 - x1*y - x*y2 + x2*y + x*y3 + x1*y2 - x2*y1 - x3*y - x*y4 + x4*y + x3*y4 - x4*y3 + (x^2*y1^2 - 2*x^2*y1*y2 + 2*x^2*y1*y3 - 2*x^2*y1*y4 + x^2*y2^2 - 2*x^2*y2*y3 + 2*x^2*y2*y4 + x^2*y3^2 - 2*x^2*y3*y4 + x^2*y4^2 - 2*x*x1*y*y1 + 2*x*x1*y*y2 - 2*x*x1*y*y3 + 2*x*x1*y*y4 + 2*x*x1*y1*y3 + 2*x*x1*y2*y3 - 4*x*x1*y2*y4 - 2*x*x1*y3^2 + 2*x*x1*y3*y4 + 2*x*x2*y*y1 - 2*x*x2*y*y2 + 2*x*x2*y*y3 - 2*x*x2*y*y4 - 4*x*x2*y1*y3 + 2*x*x2*y1*y4 + 2*x*x2*y2*y4 + 2*x*x2*y3*y4 - 2*x*x2*y4^2 - 2*x*x3*y*y1 + 2*x*x3*y*y2 - 2*x*x3*y*y3 + 2*x*x3*y*y4 - 2*x*x3*y1^2 + 2*x*x3*y1*y2 + 2*x*x3*y1*y3 + 2*x*x3*y1*y4 - 4*x*x3*y2*y4 + 2*x*x4*y*y1 - 2*x*x4*y*y2 + 2*x*x4*y*y3 - 2*x*x4*y*y4 + 2*x*x4*y1*y2 - 4*x*x4*y1*y3 - 2*x*x4*y2^2 + 2*x*x4*y2*y3 + 2*x*x4*y2*y4 + x1^2*y^2 - 2*x1^2*y*y3 + x1^2*y3^2 - 2*x1*x2*y^2 + 2*x1*x2*y*y3 + 2*x1*x2*y*y4 - 2*x1*x2*y3*y4 + 2*x1*x3*y^2 + 2*x1*x3*y*y1 - 4*x1*x3*y*y2 + 2*x1*x3*y*y3 - 4*x1*x3*y*y4 - 2*x1*x3*y1*y3 + 4*x1*x3*y2*y4 - 2*x1*x4*y^2 + 2*x1*x4*y*y2 + 2*x1*x4*y*y3 - 2*x1*x4*y2*y3 + x2^2*y^2 - 2*x2^2*y*y4 + x2^2*y4^2 - 2*x2*x3*y^2 + 2*x2*x3*y*y1 + 2*x2*x3*y*y4 - 2*x2*x3*y1*y4 + 2*x2*x4*y^2 - 4*x2*x4*y*y1 + 2*x2*x4*y*y2 - 4*x2*x4*y*y3 + 2*x2*x4*y*y4 + 4*x2*x4*y1*y3 - 2*x2*x4*y2*y4 + x3^2*y^2 - 2*x3^2*y*y1 + x3^2*y1^2 - 2*x3*x4*y^2 + 2*x3*x4*y*y1 + 2*x3*x4*y*y2 - 2*x3*x4*y1*y2 + x4^2*y^2 - 2*x4^2*y*y2 + x4^2*y2^2)^(1/2))/(x1*y3 - x3*y1 - x1*y4 - x2*y3 + x3*y2 + x4*y1 + x2*y4 - x4*y2) - (2*x*y1 - 2*x1*y - 2*x*y2 + 2*x2*y + 2*x*y3 + x1*y2 - x2*y1 - 2*x3*y - 2*x*y4 + 2*x4*y + x1*y4 - x2*y3 + x3*y2 - x4*y1 + x3*y4 - x4*y3)/(x1*y3 - x3*y1 - x1*y4 - x2*y3 + x3*y2 + x4*y1 + x2*y4 - x4*y2);
S =  (x*y1 - x1*y - x*y2 + x2*y + x*y3 + x1*y2 - x2*y1 - x3*y - x*y4 + x4*y + x3*y4 - x4*y3 + (x^2*y1^2 - 2*x^2*y1*y2 + 2*x^2*y1*y3 - 2*x^2*y1*y4 + x^2*y2^2 - 2*x^2*y2*y3 + 2*x^2*y2*y4 + x^2*y3^2 - 2*x^2*y3*y4 + x^2*y4^2 - 2*x*x1*y*y1 + 2*x*x1*y*y2 - 2*x*x1*y*y3 + 2*x*x1*y*y4 + 2*x*x1*y1*y3 + 2*x*x1*y2*y3 - 4*x*x1*y2*y4 - 2*x*x1*y3^2 + 2*x*x1*y3*y4 + 2*x*x2*y*y1 - 2*x*x2*y*y2 + 2*x*x2*y*y3 - 2*x*x2*y*y4 - 4*x*x2*y1*y3 + 2*x*x2*y1*y4 + 2*x*x2*y2*y4 + 2*x*x2*y3*y4 - 2*x*x2*y4^2 - 2*x*x3*y*y1 + 2*x*x3*y*y2 - 2*x*x3*y*y3 + 2*x*x3*y*y4 - 2*x*x3*y1^2 + 2*x*x3*y1*y2 + 2*x*x3*y1*y3 + 2*x*x3*y1*y4 - 4*x*x3*y2*y4 + 2*x*x4*y*y1 - 2*x*x4*y*y2 + 2*x*x4*y*y3 - 2*x*x4*y*y4 + 2*x*x4*y1*y2 - 4*x*x4*y1*y3 - 2*x*x4*y2^2 + 2*x*x4*y2*y3 + 2*x*x4*y2*y4 + x1^2*y^2 - 2*x1^2*y*y3 + x1^2*y3^2 - 2*x1*x2*y^2 + 2*x1*x2*y*y3 + 2*x1*x2*y*y4 - 2*x1*x2*y3*y4 + 2*x1*x3*y^2 + 2*x1*x3*y*y1 - 4*x1*x3*y*y2 + 2*x1*x3*y*y3 - 4*x1*x3*y*y4 - 2*x1*x3*y1*y3 + 4*x1*x3*y2*y4 - 2*x1*x4*y^2 + 2*x1*x4*y*y2 + 2*x1*x4*y*y3 - 2*x1*x4*y2*y3 + x2^2*y^2 - 2*x2^2*y*y4 + x2^2*y4^2 - 2*x2*x3*y^2 + 2*x2*x3*y*y1 + 2*x2*x3*y*y4 - 2*x2*x3*y1*y4 + 2*x2*x4*y^2 - 4*x2*x4*y*y1 + 2*x2*x4*y*y2 - 4*x2*x4*y*y3 + 2*x2*x4*y*y4 + 4*x2*x4*y1*y3 - 2*x2*x4*y2*y4 + x3^2*y^2 - 2*x3^2*y*y1 + x3^2*y1^2 - 2*x3*x4*y^2 + 2*x3*x4*y*y1 + 2*x3*x4*y*y2 - 2*x3*x4*y1*y2 + x4^2*y^2 - 2*x4^2*y*y2 + x4^2*y2^2)^(1/2))/(x1*y2 - x2*y1 - x1*y3 + x3*y1 + x2*y4 - x4*y2 - x3*y4 + x4*y3);

 
N1 = 1/4*(1-R)*(1-S);
N2 = 1/4*(1+R)*(1-S);
N3 = 1/4*(1+R)*(1+S);
N4 = 1/4*(1-R)*(1+S);
 


%% Triangular element

% A = 0.5*det([1  x1  y1; 1  x2  y2;  1  x3  y3]);
% 
% %%
% 
% L = 1/(2*A)*[x2*y3-x3*y2   y2-y3   x3-x2; x3*y1-x1*y3  y3-y1  x1-x3; x1*y2-x2*y1  y1-y2  x2-x1]*[1; x; y];
% 
% %%
% 
% L1 = L(1);
% L2 = L(2);
% L3 = L(3);
% 
% 
% S1 = L1*(2*L1-1);
% S2 = L2*(2*L2-1);
% S3 = L3*(2*L3-1);
% S4 = 4*L1*L2;
% S5 = 4*L2*L3;
% S6 = 4*L3*L1;